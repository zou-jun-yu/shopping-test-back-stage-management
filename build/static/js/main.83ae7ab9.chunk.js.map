{"version":3,"sources":["api/ajax.js","utils/auth.js","api/index.js","pages/Login.jsx","pages/NotFound.jsx","components/Reducer.js","config.js","pages/adminDir/Category.jsx","pages/adminDir/GoodsList.jsx","components/PicturesWall .jsx","components/LazyOptions.jsx","pages/adminDir/GoodsDetail.jsx","components/CategoryManage.jsx","pages/adminDir/GoodsManage.jsx","pages/adminDir/Order.jsx","routes/index.js","pages/Admin.jsx","App.js","serviceWorker.js","index.js"],"names":["cancel","getToken","localStorage","getItem","axios","interceptors","request","use","config","headers","cancelToken","CancelToken","c","err","Promise","reject","response","data","error","isCancel","console","log","message","post","url","get","params","loginApi","user","getSubCategoriesApi","parentId","addOrUpdateCategoryApi","category","addOrUpdateGoodsApi","goods","deleteUploadImageApi","imageName","cancelReq","Login","props","useState","loading","setLoading","onFinish","a","status","msg","token","setItem","history","push","Modal","title","name","className","initialValues","username","Item","rules","required","prefix","UserOutlined","placeholder","LockOutlined","type","htmlType","NotFound","selectedCategoryChainNodesContext","createContext","initSelectedCategoryChainNodes","_id","categoryName","_v","reducer","selectedCategoryChainNodes","action","slice","indexOf","selectedCategoryChainNode","goodsCategoryChainNodes","Error","BASE_URL","Meta","Card","Category","subCategories","setSubCategories","useContext","selectedCategoryChainNodesDispatch","useEffect","length","then","code","spinning","tip","map","key","hoverable","style","float","padding","margin","bodyStyle","cover","categoryImage","alt","height","width","src","onClick","color","textAlign","GoodsList","selectedRowKeys","setSelectedRowKeys","goodsList","setGoodsList","memoizedCallbackGetGoodsList","useCallback","categoryId","forEach","titleMap","columns","goodsName","goodsDescription","marketPrice","nowPrice","goodsImages","goodsAmount","salesNumber","Object","keys","attrName","dataIndex","ellipsis","showTitle","render","attrValue","placement","marginRight","text","record","index","start","deleteIdList","result","success","rowSelection","onChange","hasSelected","marginBottom","display","justifyContent","disabled","marginLeft","dataSource","pagination","defaultPageSize","PicturesWall","resetState","setState","initState","getImgs","state","fileList","file","handleCancel","previewVisible","handlePreview","previewImage","preview","previewTitle","substring","lastIndexOf","handleChange","image","images","uid","this","uploadButton","PlusOutlined","listType","accept","onPreview","maxNumber","visible","footer","onCancel","React","Component","LazyOptions","getSubOptions","levelOneOptions","goodsCategoryChainNodesIds","options","provideGoodsCategoryChainNodes","value","loadData","selectedOptions","targetOption","subOptions","children","isLeaf","label","goodsCategoryOptions","category1","find","option","filter","category2","category3","defaultValue","changeOnSelect","GoodsDetail","Form","useForm","form","picturesWallRef","useRef","lazyOptionsRef","tailLayout","wrapperCol","offset","span","goodsDetail","setGoodsDetail","match","id","getGoodsDetailApi","onReset","setFieldsValue","undefined","current","values","pop","labelCol","onFinishFailed","errorInfo","ref","TextArea","addonAfter","Link","Typography","withRouter","picturesWallAddRef","picturesWallUpdateRef","ModalTitle","confirmLoading","modalState","setModalState","currentCategory","setCategoryName","showModal","operationType","handleOk","categoryAfterUpdate","deleteImageResult","newCategory","fontSize","size","onOk","okText","cancelText","justify","align","gutter","e","target","Order","adminRoutes","path","component","bordered","extra","overflow","headStyle","routeProps","exact","to","Header","Layout","Content","Sider","Admin","useReducer","removeItem","mode","selectedKeys","location","pathname","split","borderRight","Provider","item","App","basename","from","Boolean","window","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.83ae7ab9.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport { getToken } from \"../utils/auth\";\r\n\r\n//封装ajax请求\r\nlet cancel;\r\n//请求拦截\r\naxios.interceptors.request.use(\r\n  (config) => {\r\n    config.headers[\"authorization\"] = getToken();\r\n    config.cancelToken = new axios.CancelToken((c) => {\r\n      cancel = c;\r\n    });\r\n    return config;\r\n  },\r\n  (err) => Promise.reject(err)\r\n);\r\n\r\n//响应拦截\r\naxios.interceptors.response.use(\r\n  (response) => {        cancel = null;\r\n  return  response.data},\r\n  error => {\r\n    if (axios.isCancel(error)) {\r\n      console.log('请求取消的错误', error.message)\r\n      return new Promise(() => {})\r\n    } else { \r\n      cancel = null\r\n      return Promise.reject(error)\r\n    }\r\n  }\r\n);\r\n\r\n//取消ajax请求\r\nfunction cancelReq() {\r\n  if (typeof cancel === 'function') {\r\n    cancel('强制取消请求')\r\n  } else {\r\n    console.log('没有可取消的请求')\r\n  }\r\n}\r\n\r\nexport const post = (url, data) => axios.post(url, data);\r\nexport const get = (url, params) => axios.get(url, { params });\r\nexport const cancelRequest = cancelReq ; \r\n\r\n","export const getToken = () => localStorage.getItem(\"token\");\r\nexport const setToken = (token) => localStorage.setItem(\"token\", token);\r\nexport const clearToken = () => localStorage.removeItem(\"token\");\r\nexport const isLogin = () => !!localStorage.getItem(\"token\");\r\n","import { post,get,cancelRequest } from \"./ajax\";\r\n\r\n//登录接口\r\nexport const loginApi = (user) => post(\"/api2/users/login\", user);\r\n\r\n//分类接口\r\nexport const getSubCategoriesApi = (parentId) => get(\"/api2/shopping/getSubCategories\", { parentId });\r\nexport const deleteCategoryApi = (_id) => post(\"/api2/shopping/deleteCategory\", {_id});\r\nexport const addOrUpdateCategoryApi = (category) => post(\"/api2/shopping/addOrUpdateCategory\", category);\r\n\r\n//商品接口\r\nexport const getGoodsListApi = (categoryId) => get(\"/api2/shopping/getGoodsList\", { categoryId });\r\nexport const deleteManyGoodsApi = (deleteIdList) => post(\"/api2/shopping/deleteManyGoods\", {deleteIdList});\r\nexport const addOrUpdateGoodsApi = (goods) => post(\"/api2/shopping/addOrUpdateGoods\", goods);\r\nexport const getGoodsDetailApi = (_id) => get(\"/api2/shopping/getGoodsDetail\", {_id});\r\n\r\n//删除上传过的图片\r\nexport const deleteUploadImageApi = (imageName) => post(\"/api2/shopping/deleteUploadImage\", {imageName});\r\n\r\n//用来取消ajax请求\r\nexport const cancelReq = cancelRequest;","import React, { useState } from \"react\";\r\nimport { Form, Input, Button, Modal } from \"antd\";\r\nimport { UserOutlined, LockOutlined } from \"@ant-design/icons\";\r\n\r\nimport \"./Login.less\";\r\nimport { loginApi } from \"../api\";\r\nimport { setToken } from \"../utils/auth\";\r\n\r\nfunction Login(props) {\r\n  const [loading, setLoading] = useState(false);\r\n  const onFinish = async (user) => {\r\n    setLoading(true);\r\n    const { status, data, msg } = await loginApi(user);\r\n    setLoading(false);\r\n    if (status === 0) {\r\n      setToken(data.token);\r\n      props.history.push(\"/admin\");\r\n    } else {\r\n      Modal.error({ title: msg });\r\n    }\r\n  };\r\n  return (\r\n    <Form\r\n      name=\"normal_login\"\r\n      className=\"login-form\"\r\n      initialValues={{ username: \"admin\" }}\r\n      onFinish={onFinish}\r\n    >\r\n      <h2>用户登录</h2>\r\n      <Form.Item\r\n        name=\"username\"\r\n        rules={[{ required: true, message: \"请输入您的用户名!\" }]}\r\n      >\r\n        <Input\r\n          prefix={<UserOutlined className=\"site-form-item-icon\" />}\r\n          placeholder=\"用户名\"\r\n        />\r\n      </Form.Item>\r\n      <Form.Item\r\n        name=\"password\"\r\n        rules={[{ required: true, message: \"请输入您的密码!\" }]}\r\n      >\r\n        <Input\r\n          prefix={<LockOutlined className=\"site-form-item-icon\" />}\r\n          type=\"password\"\r\n          placeholder=\"密码\"\r\n        />\r\n      </Form.Item>\r\n      <Form.Item>\r\n        <Button\r\n          type=\"primary\"\r\n          htmlType=\"submit\"\r\n          className=\"login-form-button\"\r\n          loading={loading}\r\n        >\r\n          登录\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","import React from 'react'\r\n\r\nfunction NotFound() {\r\n    return (\r\n        <div>\r\n            404\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NotFound\r\n","import { createContext } from \"react\";\r\n\r\n//选中一个分类，接着选中它的子分类中的某一个，再选中它的下下级分类中的某一个...依次类推，将这几个选中的分类按顺序放在一个数组中，就形成了一个分类链。即某个分类跟它的所有祖先分类按顺序连在一起组成一个分类链。\r\nexport const selectedCategoryChainNodesContext = createContext(null);\r\n\r\n//初始分类链，只有一个分类对象\r\nexport const initSelectedCategoryChainNodes = [\r\n  { _id: \"0\", categoryName: \"一级分类列表\", parentId: -1, _v: -1 },\r\n];\r\n\r\nexport const reducer = (selectedCategoryChainNodes, action) => {\r\n  switch (action.type) {\r\n    //点击分类链中的中间某一个时，会截断后面的\r\n    case \"clickSelectedCategoryChainNode\":\r\n      return selectedCategoryChainNodes.slice(\r\n        0,\r\n        selectedCategoryChainNodes.indexOf(action.selectedCategoryChainNode) + 1\r\n      );\r\n    //点击分类列表中的某个分类时，会将该分类加到分类链末端\r\n    case \"pushSelectedCategoryChainNode\":\r\n      return [...selectedCategoryChainNodes, action.category];\r\n    //根据某个商品获取它的所有祖先串起来就得到一个分类链\r\n    case \"getSelectedCategoryChainNodesFromGoodsDetail\":\r\n      return [\r\n        ...initSelectedCategoryChainNodes,\r\n        ...action.goodsCategoryChainNodes,\r\n      ];\r\n    default:\r\n      throw new Error();\r\n  }\r\n};\r\n\r\n\r\n","//setupProxy.js文件中直接使用了http://localhost:5000而不是BASE_URL。\r\nexport const BASE_URL = \"http://localhost:5000\";\r\n\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport { message, Card, Spin } from \"antd\";\r\n\r\nimport { getSubCategoriesApi, cancelReq } from \"../../api\";\r\nimport { selectedCategoryChainNodesContext } from \"../../components/Reducer\";\r\nimport { BASE_URL } from \"../../config\";\r\n\r\nconst { Meta } = Card;\r\n\r\nfunction Category(props) {\r\n  const [subCategories, setSubCategories] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const {\r\n    selectedCategoryChainNodes,\r\n    selectedCategoryChainNodesDispatch,\r\n  } = useContext(selectedCategoryChainNodesContext);\r\n\r\n  useEffect(() => {\r\n    //一个有3个层级的分类，加上开头那个“一级分类列表”就是4个。当分类连长度达到4后，就该跳到商品列表页显示商品列表了。\r\n    if (selectedCategoryChainNodes.length >= 4) {\r\n      props.history.push(\"/admin/goodsManage/goodsList\");\r\n    } else {\r\n      //获取分类链最后一个节点的所有子分类列表并把它们显示在页面上\r\n      setLoading(true);\r\n      getSubCategoriesApi(\r\n        selectedCategoryChainNodes[selectedCategoryChainNodes.length - 1]._id\r\n      ).then(({ code, data, msg }) => {\r\n        setLoading(false);\r\n        if (code === 0) {\r\n          setSubCategories(data.subCategories);\r\n        } else {\r\n          message.error(msg);\r\n        }\r\n      });\r\n    }\r\n    return cancelReq;\r\n  }, [selectedCategoryChainNodes, props.history]);\r\n\r\n  return (\r\n    <Spin spinning={loading} tip=\"Loading...\">\r\n      <div>\r\n        {subCategories.map((category) => (\r\n          <Card\r\n            key={category._id}\r\n            hoverable\r\n            style={{ float: \"left\", padding: 10, margin: 10 }}\r\n            bodyStyle={{ padding: 0 }}\r\n            //如果subCategories是三级分类列表，则还要显示每一个分类的图片\r\n            cover={\r\n              category.categoryImage ? (\r\n                <img\r\n                  alt=\"商品分类图片\"\r\n                  style={{ height: 105, width: 105 }}\r\n                  src={BASE_URL + \"/images/uploads/\" + category.categoryImage}\r\n                />\r\n              ) : null\r\n            }\r\n            onClick={() => {\r\n              selectedCategoryChainNodesDispatch({\r\n                type: \"pushSelectedCategoryChainNode\",\r\n                category,\r\n              });\r\n            }}\r\n          >\r\n            <Meta\r\n              title={\r\n                <span style={{ color: \"#999999\" }}>\r\n                  {category.categoryName}\r\n                </span>\r\n              }\r\n              style={{ textAlign: \"center\", width: 105 }}\r\n            />\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    </Spin>\r\n  );\r\n}\r\n\r\nexport default Category;\r\n","import React, { useState, useEffect, useContext, useCallback } from \"react\";\r\nimport { message, Button, Table, Tooltip } from \"antd\";\r\n\r\nimport { getGoodsListApi, deleteManyGoodsApi, cancelReq } from \"../../api\";\r\nimport { selectedCategoryChainNodesContext } from \"../../components/Reducer\";\r\nimport { BASE_URL } from \"../../config\";\r\n\r\nfunction GoodsList(props) {\r\n  const [selectedRowKeys, setSelectedRowKeys] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const { selectedCategoryChainNodes } = useContext(\r\n    selectedCategoryChainNodesContext\r\n  );\r\n  const [goodsList, setGoodsList] = useState([]);\r\n\r\n  //根据当前选中的分类链末端（是一个三级分类）的id请求获取该分类下的商品列表\r\n  const memoizedCallbackGetGoodsList = useCallback(() => {\r\n    setLoading(true);\r\n    getGoodsListApi(\r\n      selectedCategoryChainNodes[selectedCategoryChainNodes.length - 1]._id\r\n    ).then(({ code, data, msg }) => {\r\n      if (code === 0) {\r\n        data.goodsList.forEach((goods) => {\r\n          goods.key = goods._id;\r\n        });\r\n        setGoodsList(data.goodsList);\r\n        setLoading(false);\r\n      } else {\r\n        message.error(msg);\r\n      }\r\n    });\r\n  }, [selectedCategoryChainNodes]);\r\n\r\n  useEffect(() => {\r\n    memoizedCallbackGetGoodsList();\r\n    return cancelReq;\r\n  }, [memoizedCallbackGetGoodsList]);\r\n\r\n  //设置表格头部\r\n  let titleMap = {},\r\n    columns = [];\r\n  if (goodsList.length) {\r\n    titleMap = {\r\n      goodsName: \"商品名称\",\r\n      goodsDescription: \"商品描述\",\r\n      marketPrice: \"原价\",\r\n      nowPrice: \"现价\",\r\n      goodsImages: \"商品图片\",\r\n      goodsAmount: \"库存量\",\r\n      salesNumber: \"已售\",\r\n    };\r\n    columns = Object.keys(titleMap).map((attrName) => {\r\n      const config = {\r\n        title: titleMap[attrName],\r\n        key: attrName,\r\n        dataIndex: attrName,\r\n        ellipsis: {\r\n          showTitle: false,\r\n        },\r\n      };\r\n      if (attrName === \"goodsImages\") {\r\n        return {\r\n          ...config,\r\n          width: 200,\r\n          render: (attrValue) => (\r\n            <Tooltip\r\n              placement=\"left\"\r\n              title={attrValue.map((imageName) => (\r\n                <img\r\n                  src={BASE_URL + \"/images/uploads/\" + imageName}\r\n                  alt=\"商品图片\"\r\n                  key={imageName}\r\n                  style={{ height: 150, width: 150, margin: 4 }}\r\n                />\r\n              ))}\r\n            >\r\n              {attrValue.map((imageName) => (\r\n                <img\r\n                  src={BASE_URL + \"/images/uploads/\" + imageName}\r\n                  alt=\"商品图片\"\r\n                  key={imageName}\r\n                  style={{ height: 70, width: 70, marginRight: 2 }}\r\n                />\r\n              ))}\r\n            </Tooltip>\r\n          ),\r\n        };\r\n      } else {\r\n        return {\r\n          ...config,\r\n          width: attrName === \"goodsDescription\" ? 300 : \"auto\",\r\n          render: (attrValue) => (\r\n            <Tooltip placement=\"topLeft\" title={attrValue}>\r\n              {attrValue}\r\n            </Tooltip>\r\n          ),\r\n        };\r\n      }\r\n    });\r\n    columns.push({\r\n      title: \"操作\",\r\n      key: \"operation\",\r\n      render: (text, record, index) => {\r\n        return (\r\n          <div>\r\n            <Button\r\n              onClick={() => {\r\n                props.history.push(\r\n                  `/admin/goodsManage/goodsDetail/${record._id}`\r\n                );\r\n              }}\r\n            >\r\n              编辑\r\n            </Button>\r\n          </div>\r\n        );\r\n      },\r\n    });\r\n  }\r\n\r\n  //发出删除商品请求\r\n  const start = async () => {\r\n    setLoading(true);\r\n    const result = await deleteManyGoodsApi(selectedRowKeys);\r\n    const { code, msg, data } = result;\r\n    if (code === 0) {\r\n      console.log(data);\r\n      message.success(msg);\r\n      setSelectedRowKeys([]);\r\n      memoizedCallbackGetGoodsList();\r\n    } else {\r\n      message.error(msg);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const onSelectChange = (selectedRowKeys) => {\r\n    console.log(\"selectedRowKeys changed: \", selectedRowKeys);\r\n    setSelectedRowKeys(selectedRowKeys);\r\n  };\r\n\r\n  const rowSelection = {\r\n    selectedRowKeys,\r\n    onChange: onSelectChange,\r\n  };\r\n  const hasSelected = selectedRowKeys.length > 0;\r\n\r\n  return (\r\n    <div>\r\n      <div\r\n        style={{\r\n          marginBottom: 16,\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n        }}\r\n      >\r\n        <div>\r\n          <Button\r\n            type=\"primary\"\r\n            onClick={start}\r\n            disabled={!hasSelected}\r\n          >\r\n            删除选中商品\r\n          </Button>\r\n          <span style={{ marginLeft: 8 }}>\r\n            {hasSelected ? `已选中 ${selectedRowKeys.length} 种商品` : \"\"}\r\n          </span>\r\n        </div>\r\n        <Button\r\n          onClick={() => {\r\n            props.history.push(\"/admin/goodsManage/goodsDetail\");\r\n          }}\r\n        >\r\n          添加商品\r\n        </Button>\r\n      </div>\r\n      <Table\r\n        rowSelection={rowSelection}\r\n        columns={columns}\r\n        dataSource={goodsList}\r\n        loading={loading}\r\n        pagination={{\r\n          defaultPageSize: 2,\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GoodsList;\r\n","import React from \"react\";\r\nimport { Upload, Modal, message } from \"antd\";\r\nimport PropTypes from \"prop-types\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\n\r\nimport { deleteUploadImageApi, cancelReq } from \"../api\";\r\nimport { BASE_URL } from \"../config\";\r\n\r\n//图片上传组件\r\nexport default class PicturesWall extends React.Component {\r\n  static propTypes = {\r\n    images: PropTypes.array,\r\n    maxNumber: PropTypes.number,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.initState = {\r\n      previewVisible: false,\r\n      previewImage: \"\",\r\n      previewTitle: \"\",\r\n      fileList: [],\r\n    };\r\n    //初始化显示是否已经上传果图片\r\n    const fileList = this.props.images.map((src, index) => ({\r\n      uid: -index + \"\",\r\n      name: src,\r\n      status: \"done\",\r\n      url: BASE_URL + \"/images/uploads/\" + src,\r\n    }));\r\n    this.state = { ...this.initState, fileList };\r\n  }\r\n\r\n  //跳转到其它页面时，取消ajax请求\r\n  componentWillUnmount(){\r\n    cancelReq();\r\n  }\r\n\r\n  resetState = () => {\r\n    this.setState(this.initState);\r\n  };\r\n\r\n  //向往提供当前商品上传了哪些图片的信息\r\n  getImgs = () => {\r\n    return this.state.fileList.map((file) => file.name);\r\n  };\r\n\r\n  //隐藏预览大图模态窗\r\n  handleCancel = () => this.setState({ previewVisible: false });\r\n\r\n  //显示大图预览\r\n  handlePreview = async (file) => {\r\n    this.setState({\r\n      previewImage: file.url || file.preview,\r\n      previewVisible: true,\r\n      previewTitle:\r\n        file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1),\r\n    });\r\n  };\r\n\r\n  handleChange = async ({ fileList, file }) => {\r\n    if (file.status === \"done\") {\r\n      //当成功上传图片时，更新图片列表\r\n      const result = file.response;\r\n      if (result.code === 0) {\r\n        message.success(result.msg);\r\n        const src = result.data.src;\r\n        const image = fileList[fileList.length - 1];\r\n        image.url = src;\r\n        image.name = image.url.substring(image.url.lastIndexOf(\"/\") + 1);\r\n      } else {\r\n        message.error(result.msg);\r\n      }\r\n    } else if (file.status === \"removed\") {\r\n      //删除上传的图片\r\n      const result = await deleteUploadImageApi(file.name);\r\n      if (result.code === 0) {\r\n        message.success(result.msg);\r\n      } else {\r\n        message.error(result.msg);\r\n      }\r\n    }\r\n    this.setState({ fileList });\r\n  };\r\n\r\n  render() {\r\n    const { previewVisible, previewImage, fileList, previewTitle } = this.state;\r\n    const uploadButton = (\r\n      <div>\r\n        <PlusOutlined />\r\n        <div className=\"ant-upload-text\">Upload</div>\r\n      </div>\r\n    );\r\n    return (\r\n      <div className=\"clearfix\">\r\n        <Upload\r\n          action=\"/api2/shopping/uploadImage\"\r\n          listType=\"picture-card\"\r\n          fileList={fileList}\r\n          accept=\"image/*\"\r\n          name=\"goods\"\r\n          onPreview={this.handlePreview}\r\n          onChange={this.handleChange}\r\n        >\r\n          {fileList.length >= (this.props.maxNumber || 5) ? null : uploadButton}\r\n        </Upload>\r\n        <Modal\r\n          visible={previewVisible}\r\n          title={previewTitle}\r\n          footer={null}\r\n          onCancel={this.handleCancel}\r\n        >\r\n          <img alt=\"商品图片\" style={{ width: \"100%\" }} src={previewImage} />\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { Cascader } from \"antd\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { getSubCategoriesApi,cancelReq } from \"../api\";\r\n\r\n//级联下拉选择框（懒加载）\r\nexport default class LazyOptions extends React.Component {\r\n  static propTypes = {\r\n    goodsCategoryChainNodes: PropTypes.array,\r\n    goodsCategoryOptions: PropTypes.array,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      options: [],\r\n      //下面这个属性是否存在决定了当前操作是增加商品还是修改商品\r\n      goodsCategoryChainNodesIds: this.props.goodsCategoryChainNodes\r\n        ? this.props.goodsCategoryChainNodes.map((category) => category._id)\r\n        : null,\r\n    };\r\n  }\r\n\r\n  //重置级联选择输入框\r\n  resetState = async () => {\r\n    const levelOneOptions = await this.getSubOptions(\"0\");\r\n    this.setState({\r\n      goodsCategoryChainNodesIds: [],\r\n      options: levelOneOptions,\r\n    });\r\n  };\r\n\r\n  //向外暴露当前选中的分类\r\n  provideGoodsCategoryChainNodes = () => this.state.goodsCategoryChainNodesIds;\r\n\r\n  //当前选中的分类改变时调用\r\n  onChange = (value) => {\r\n    this.setState({ goodsCategoryChainNodesIds: value });\r\n  };\r\n\r\n  //当选择某个分类时，加载它的子分类列表\r\n  loadData = async (selectedOptions) => {\r\n    const length = selectedOptions.length;\r\n    const targetOption = selectedOptions[length - 1];\r\n    targetOption.loading = true;\r\n    const subOptions = await this.getSubOptions(\r\n      targetOption.value,\r\n      length === 2\r\n    );\r\n    targetOption.loading = false;\r\n    targetOption.children = subOptions;\r\n    this.setState({\r\n      options: [...this.state.options],\r\n    });\r\n  };\r\n\r\n  //请求一个分类的子分类列表，并将结果转化成级联选择框的数据源\r\n  getSubOptions = async (parentId, isLeaf = false) => {\r\n    const result = await getSubCategoriesApi(parentId);\r\n    const subCategories = result.data.subCategories;\r\n    const subOptions = subCategories.map((category) => ({\r\n      value: category._id,\r\n      label: category.categoryName,\r\n      isLeaf,\r\n    }));\r\n    return subOptions;\r\n  };\r\n\r\n  async componentDidMount() {\r\n    const { goodsCategoryChainNodesIds } = this.state;\r\n    if (!goodsCategoryChainNodesIds) {\r\n      //说明当前是在添加商品，只获取所有一级商品分类即可初始化级联选择框\r\n      const levelOneOptions = await this.getSubOptions(\"0\");\r\n      this.setState({ options: levelOneOptions });\r\n    } else {\r\n      //说明当前正在修改商品，要把当前商品的祖先分类转化成数据源格式，然后渲染到级联选择输入框\r\n      const { goodsCategoryOptions } = this.props;\r\n      const levelOneOptions = goodsCategoryOptions.map((category1) => ({\r\n        value: category1._id,\r\n        label: category1.categoryName,\r\n        isLeaf: false,\r\n      }));\r\n      let targetOption = levelOneOptions.find(\r\n        (option) => option.value === goodsCategoryChainNodesIds[0]\r\n      );\r\n      targetOption.children = goodsCategoryOptions\r\n        .filter(\r\n          (category1) => category1._id === goodsCategoryChainNodesIds[0]\r\n        )[0]\r\n        .children.map((category2) => ({\r\n          value: category2._id,\r\n          label: category2.categoryName,\r\n          isLeaf: false,\r\n        }));\r\n\r\n      targetOption = targetOption.children.find(\r\n        (option) => option.value === goodsCategoryChainNodesIds[1]\r\n      );\r\n      targetOption.children = goodsCategoryOptions\r\n        .filter(\r\n          (category1) => category1._id === goodsCategoryChainNodesIds[0]\r\n        )[0]\r\n        .children.filter(\r\n          (category2) => category2._id === goodsCategoryChainNodesIds[1]\r\n        )[0]\r\n        .children.map((category3) => ({\r\n          value: category3._id,\r\n          label: category3.categoryName,\r\n          isLeaf: true,\r\n        }));\r\n      this.setState({ options: levelOneOptions });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    cancelReq();\r\n  }\r\n  render() {\r\n    const { goodsCategoryChainNodesIds } = this.state;\r\n    return (\r\n      <Cascader\r\n        options={this.state.options}\r\n        loadData={this.loadData}\r\n        onChange={this.onChange}\r\n        defaultValue={goodsCategoryChainNodesIds}\r\n        changeOnSelect\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React, { useRef, useEffect, useState, useContext } from \"react\";\r\nimport { Form, Input, Button, message } from \"antd\";\r\n\r\nimport PicturesWall from \"../../components/PicturesWall \";\r\nimport LazyOptions from \"../../components/LazyOptions\";\r\nimport { addOrUpdateGoodsApi, getGoodsDetailApi, cancelReq } from \"../../api\";\r\nimport { selectedCategoryChainNodesContext } from \"../../components/Reducer\";\r\n\r\nimport \"./GoodsDetail.less\";\r\n\r\nfunction GoodsDetail(props) {\r\n  const [form] = Form.useForm();\r\n  //图片上传组件\r\n  const picturesWallRef = useRef(null);\r\n  //级联选择下拉框\r\n  const lazyOptionsRef = useRef(null);\r\n\r\n  const layout = {\r\n    labelCol: {\r\n      span: 4,\r\n    },\r\n    wrapperCol: {\r\n      span: 12,\r\n    },\r\n  };\r\n  const tailLayout = {\r\n    wrapperCol: {\r\n      offset: 4,\r\n      span: 12,\r\n    },\r\n  };\r\n\r\n  const [goodsDetail, setGoodsDetail] = useState(null);\r\n  //用于修改分类链的dispatch方法\r\n  const { selectedCategoryChainNodesDispatch } = useContext(\r\n    selectedCategoryChainNodesContext\r\n  );\r\n  useEffect(() => {\r\n    const _id = props.match.params.id;\r\n    //如果动态路由参数id存在，那么就是修改商品信息。否则就是添加商品。\r\n    if (_id) {\r\n      getGoodsDetailApi(_id).then((result) => {\r\n        const { code, msg, data } = result;\r\n        if (code === 0) {\r\n          setGoodsDetail({\r\n            ...data.goodsDetail,\r\n            goodsCategoryChainNodes: data.goodsCategoryChainNodes,\r\n            goodsCategoryOptions: data.goodsCategoryOptions,\r\n          });\r\n          selectedCategoryChainNodesDispatch({\r\n            type: \"getSelectedCategoryChainNodesFromGoodsDetail\",\r\n            goodsCategoryChainNodes: data.goodsCategoryChainNodes,\r\n          });\r\n        } else {\r\n          message.error(msg);\r\n        }\r\n      });\r\n    }\r\n    return cancelReq;\r\n  }, [props.match.params.id, selectedCategoryChainNodesDispatch]);\r\n\r\n  //重置表单\r\n  const onReset = () => {\r\n    form.setFieldsValue({\r\n      goodsName: \"\",\r\n      goodsDescription: \"\",\r\n      marketPrice: undefined,\r\n      nowPrice: undefined,\r\n      goodsAmount: undefined,\r\n    });\r\n    lazyOptionsRef.current.resetState();\r\n    picturesWallRef.current.resetState();\r\n  };\r\n\r\n  //提交表单时调用此方法\r\n  const onFinish = async (values) => {\r\n    values.marketPrice *= 1;\r\n    values.nowPrice *= 1;\r\n    let goods = {\r\n      ...values,\r\n      categoryId: lazyOptionsRef.current.provideGoodsCategoryChainNodes().pop(),\r\n      goodsImages: picturesWallRef.current.getImgs(),\r\n    };\r\n    if (props.match.params.id) {\r\n      goods._id = props.match.params.id;\r\n    }\r\n    const result = await addOrUpdateGoodsApi(goods);\r\n    if (result.code === 0) {\r\n      message.success(result.msg);\r\n      onReset();\r\n    } else {\r\n      message.error(result.msg);\r\n    }\r\n  };\r\n\r\n  const onFinishFailed = (errorInfo) => {\r\n    message.error(\"保存商品失败\");\r\n  };\r\n\r\n  return goodsDetail || !props.match.params.id ? (\r\n    <Form\r\n      {...layout}\r\n      name=\"basic\"\r\n      form={form}\r\n      initialValues={\r\n        goodsDetail\r\n          ? {\r\n              goodsName: goodsDetail.goodsName,\r\n              goodsDescription: goodsDetail.goodsDescription,\r\n              marketPrice: goodsDetail.marketPrice,\r\n              nowPrice: goodsDetail.nowPrice,\r\n              goodsAmount: goodsDetail.goodsAmount,\r\n            }\r\n          : {}\r\n      }\r\n      onFinish={onFinish}\r\n      onFinishFailed={onFinishFailed}\r\n    >\r\n      <Form.Item\r\n        label=\"商品分类\"\r\n        rules={[{ required: true, message: \"请选择商品分类\" }]}\r\n      >\r\n        <LazyOptions\r\n          ref={lazyOptionsRef}\r\n          goodsCategoryChainNodes={\r\n            goodsDetail ? goodsDetail.goodsCategoryChainNodes : null\r\n          }\r\n          goodsCategoryOptions={\r\n            goodsDetail ? goodsDetail.goodsCategoryOptions : null\r\n          }\r\n        />\r\n      </Form.Item>\r\n      <Form.Item\r\n        label=\"商品名称 \"\r\n        name=\"goodsName\"\r\n        rules={[{ required: true, message: \"请选请输入商品名称\" }]}\r\n      >\r\n        <Input />\r\n      </Form.Item>\r\n      <Form.Item label=\"商品描述\" name=\"goodsDescription\">\r\n        <Input.TextArea />\r\n      </Form.Item>\r\n      <Form.Item\r\n        label=\"原价\"\r\n        name=\"marketPrice\"\r\n        rules={[{ required: true, message: \"请选请输入商品原价\" }]}\r\n      >\r\n        <Input type=\"number\" addonAfter=\"元\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        label=\"现价\"\r\n        name=\"nowPrice\"\r\n        rules={[{ required: true, message: \"请选请输入商品现价\" }]}\r\n      >\r\n        <Input type=\"number\" addonAfter=\"元\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        label=\"商品数量\"\r\n        name=\"goodsAmount\"\r\n        rules={[{ required: true, message: \"请输入此商品的数量\" }]}\r\n      >\r\n        <Input type=\"number\" />\r\n      </Form.Item>\r\n      <Form.Item label=\"上传图片\">\r\n        <PicturesWall\r\n          ref={picturesWallRef}\r\n          images={goodsDetail ? goodsDetail.goodsImages : []}\r\n        />\r\n      </Form.Item>\r\n      <Form.Item {...tailLayout}>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          保存\r\n        </Button>\r\n        <Button htmlType=\"button\" onClick={onReset}>\r\n          清空\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  ) : (\r\n    \"Loading...\"\r\n  );\r\n}\r\n\r\nexport default GoodsDetail;\r\n","import React, { useContext, useState, useEffect, useRef } from \"react\";\r\nimport { Input, message, Modal, Row, Col, Space, Typography } from \"antd\";\r\nimport { withRouter } from \"react-router-dom\";\r\n\r\nimport {\r\n  addOrUpdateCategoryApi,\r\n  deleteCategoryApi,\r\n  deleteUploadImageApi,\r\n} from \"../api\";\r\nimport PicturesWall from \"./PicturesWall \";\r\nimport { selectedCategoryChainNodesContext } from \"./Reducer\";\r\n\r\nconst { Link } = Typography;\r\n\r\nconst CategoryManage = (props) => {\r\n  //图片上传组件\r\n  const picturesWallAddRef = useRef(null);\r\n  const picturesWallUpdateRef = useRef(null);\r\n\r\n  //模态框\r\n  const [modalState, setModalState] = useState({\r\n    ModalTitle: \"\",\r\n    visible: false,\r\n    confirmLoading: false,\r\n  });\r\n\r\n  //当前分类链，以及改变分类链的dispatch方法\r\n  const {\r\n    selectedCategoryChainNodes,\r\n    selectedCategoryChainNodesDispatch,\r\n  } = useContext(selectedCategoryChainNodesContext);\r\n\r\n  //分类链中的最后一个分类是当前分类\r\n  const currentCategory =\r\n    selectedCategoryChainNodes[selectedCategoryChainNodes.length - 1];\r\n  //当前分类的名字\r\n  const [categoryName, setCategoryName] = useState(\r\n    currentCategory.categoryName\r\n  );\r\n\r\n  //当前分类变化时，取得最新的当前分类的名字\r\n  useEffect(() => {\r\n    setCategoryName(currentCategory.categoryName);\r\n  }, [currentCategory.categoryName]);\r\n\r\n  //显示模态框\r\n  const showModal = (operationType) => {\r\n    setModalState({\r\n      ModalTitle: operationType,\r\n      visible: true,\r\n      confirmLoading: false,\r\n    });\r\n    if (operationType === \"添加分类\") {\r\n      setCategoryName(\"\");\r\n    }\r\n  };\r\n\r\n  //点击确定按钮时\r\n  const handleOk = async () => {\r\n    setModalState((modalState) => ({\r\n      ...modalState,\r\n      confirmLoading: true,\r\n    }));\r\n    let result, deleteImageResult;\r\n    switch (modalState.ModalTitle) {\r\n      case \"修改分类\":\r\n        const categoryAfterUpdate = {\r\n          ...currentCategory,\r\n          categoryName,\r\n        };\r\n        if (picturesWallUpdateRef.current.getImgs().length) {\r\n          //选择图片上传组件的第一张图片作为新分类的图片\r\n          categoryAfterUpdate.categoryImage = picturesWallUpdateRef.current.getImgs()[0];\r\n        } else {\r\n          //图片上传组件没有图片时，删除新分类的图片\r\n          delete categoryAfterUpdate.categoryImage;\r\n        }\r\n        result = await addOrUpdateCategoryApi(categoryAfterUpdate);\r\n        break;\r\n      case \"删除分类\":\r\n        if (currentCategory.categoryImage) {\r\n          //先删除当前分类的图片\r\n          deleteImageResult = await deleteUploadImageApi(\r\n            currentCategory.categoryImage\r\n          );\r\n        }\r\n        //再删除当前分类\r\n        result = await deleteCategoryApi(currentCategory._id);\r\n        if (deleteImageResult && deleteImageResult.code !== 0) {\r\n          result = deleteImageResult;\r\n        }\r\n        break;\r\n      case \"添加分类\":\r\n        //为当前分类添加一个子分类对象\r\n        const newCategory = {\r\n          parentId: currentCategory._id,\r\n          categoryName,\r\n        };\r\n        if (picturesWallAddRef.current.getImgs().length) {\r\n          newCategory.categoryImage = picturesWallAddRef.current.getImgs()[0];\r\n        }\r\n        result = await addOrUpdateCategoryApi(newCategory);\r\n        break;\r\n      default:\r\n        throw new Error(\"操作类型错误\");\r\n    }\r\n    const { code, msg } = result;\r\n    if (code === 0) {\r\n      message.success(msg);\r\n    } else {\r\n      message.error(msg);\r\n    }\r\n    setModalState({\r\n      ModalTitle: \"\",\r\n      visible: false,\r\n      confirmLoading: false,\r\n    });\r\n    //修改状态重新回到“一级分类列表”\r\n    selectedCategoryChainNodesDispatch({\r\n      type: \"clickSelectedCategoryChainNode\",\r\n      selectedCategoryChainNode: selectedCategoryChainNodes[0],\r\n    });\r\n    props.history.push(\"/admin/goodsManage/category\");\r\n  };\r\n\r\n  //如果点击了取消按钮\r\n  const handleCancel = () => {\r\n    setModalState({\r\n      ModalTitle: \"\",\r\n      visible: false,\r\n      confirmLoading: false,\r\n    });\r\n    setCategoryName(currentCategory.categoryName);\r\n  };\r\n\r\n  const { visible, confirmLoading, ModalTitle } = modalState;\r\n\r\n  return (\r\n    <div style={{ fontSize: 16 }}>\r\n      <Space size={50}>\r\n        {/* 三级分类列表下不能再添加子分类了 */}\r\n        {selectedCategoryChainNodes.length < 4 ? (\r\n          <Link onClick={() => showModal(\"添加分类\")}>添加分类</Link>\r\n        ) : null}\r\n        {/* 不能删除和修改根分类节点 */}\r\n        {selectedCategoryChainNodes.length > 1 ? (\r\n          <>\r\n            <Link onClick={() => showModal(\"修改分类\")}>修改分类</Link>\r\n            <Link onClick={() => showModal(\"删除分类\")}>删除分类</Link>\r\n          </>\r\n        ) : null}\r\n      </Space>\r\n      <Modal\r\n        title={ModalTitle}\r\n        visible={visible}\r\n        onOk={handleOk}\r\n        confirmLoading={confirmLoading}\r\n        onCancel={handleCancel}\r\n        okText=\"确认\"\r\n        cancelText=\"取消\"\r\n      >\r\n        {/* 根据ModalTitle显示哪一个模态框 */}\r\n        {ModalTitle === \"修改分类\" ? (\r\n          <>\r\n            <Row justify=\"space-around\" align=\"middle\" gutter={[10, 30]}>\r\n              <Col span={4}>分类名称：</Col>\r\n              <Col span={20}>\r\n                <Input\r\n                  value={categoryName}\r\n                  onChange={(e) => {\r\n                    setCategoryName(e.target.value);\r\n                  }}\r\n                />\r\n              </Col>\r\n            </Row>\r\n            {currentCategory.categoryImage ? (\r\n              <Row gutter={[10, 30]}>\r\n                <Col offset={4}>\r\n                  <PicturesWall\r\n                    ref={picturesWallUpdateRef}\r\n                    images={[currentCategory.categoryImage]}\r\n                    maxNumber={1}\r\n                  />\r\n                </Col>\r\n              </Row>\r\n            ) : null}\r\n          </>\r\n        ) : ModalTitle === \"删除分类\" ? (\r\n          <Row justify=\"space-around\" align=\"middle\" gutter={[10, 30]}>\r\n            <Col span={6}>确认删除分类:</Col>\r\n            <Col span={16}>{currentCategory.categoryName}？</Col>\r\n          </Row>\r\n        ) : (\r\n          <>\r\n            <Row justify=\"space-around\" align=\"middle\" gutter={[10, 30]}>\r\n              <Col span={4}>上级分类：</Col>\r\n              <Col span={20}>\r\n                {selectedCategoryChainNodes.map(\r\n                  (selectedCategoryChainNode) =>\r\n                    \" / \" + selectedCategoryChainNode.categoryName\r\n                )}\r\n              </Col>\r\n            </Row>\r\n            <Row justify=\"space-around\" align=\"middle\" gutter={[10, 30]}>\r\n              <Col span={4}>分类名称：</Col>\r\n              <Col span={20}>\r\n                <Input\r\n                  value={categoryName}\r\n                  onChange={(e) => {\r\n                    setCategoryName(e.target.value);\r\n                  }}\r\n                />\r\n              </Col>\r\n            </Row>\r\n            {selectedCategoryChainNodes.length === 3 ? (\r\n              <Row gutter={[10, 30]}>\r\n                <Col offset={4}>\r\n                  <PicturesWall\r\n                    ref={picturesWallAddRef}\r\n                    maxNumber={1}\r\n                    images={[]}\r\n                  />\r\n                </Col>\r\n              </Row>\r\n            ) : null}\r\n          </>\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withRouter(CategoryManage);\r\n","import React, { useContext } from \"react\";\r\nimport { Switch, Route, Redirect } from \"react-router-dom\";\r\nimport { Card, Breadcrumb, Typography } from \"antd\";\r\n\r\nimport Category from \"./Category\";\r\nimport GoodsList from \"./GoodsList\";\r\nimport GoodsDetail from \"./GoodsDetail\";\r\nimport { selectedCategoryChainNodesContext } from \"../../components/Reducer\";\r\nimport CategoryManage from \"../../components/CategoryManage\";\r\n\r\nconst { Link } = Typography;\r\n\r\n//商品和商品种类管理\r\nfunction GoodsManage(props) {\r\n  const {\r\n    selectedCategoryChainNodes,\r\n    selectedCategoryChainNodesDispatch,\r\n  } = useContext(selectedCategoryChainNodesContext);\r\n\r\n  return (\r\n    <Card\r\n      title={\r\n        <Breadcrumb style={{ margin: \"16px 0\", fontSize: 16 }}>\r\n          {selectedCategoryChainNodes.map((selectedCategoryChainNode) => (\r\n            <Breadcrumb.Item key={selectedCategoryChainNode._id}>\r\n              <Link\r\n                onClick={() => {\r\n                  selectedCategoryChainNodesDispatch({\r\n                    type: \"clickSelectedCategoryChainNode\",\r\n                    selectedCategoryChainNode,\r\n                  });\r\n                  props.history.push(\"/admin/goodsManage/category\");\r\n                }}\r\n              >\r\n                {selectedCategoryChainNode.categoryName}\r\n              </Link>\r\n            </Breadcrumb.Item>\r\n          ))}\r\n        </Breadcrumb>\r\n      }\r\n      bordered={false}\r\n      extra={<CategoryManage />}\r\n      style={{ height: \"100%\", overflow: \"auto\" }}\r\n      headStyle={{ fontSize: 20 }}\r\n    >\r\n      <Switch>\r\n        <Route\r\n          path=\"/admin/goodsManage/category\"\r\n          render={(routeProps) => <Category {...routeProps} />}\r\n        />\r\n        <Route\r\n          path=\"/admin/goodsManage/goodsList\"\r\n          render={(routeProps) => <GoodsList {...routeProps} />}\r\n        />\r\n        <Route\r\n          path=\"/admin/goodsManage/goodsDetail\"\r\n          exact={true}\r\n          render={(routeProps) => <GoodsDetail {...routeProps} />}\r\n        />\r\n        <Route\r\n          path=\"/admin/goodsManage/goodsDetail/:id\"\r\n          render={(routeProps) => <GoodsDetail {...routeProps} />}\r\n        />\r\n        <Redirect to=\"/admin/goodsManage/category\" />\r\n      </Switch>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default GoodsManage;\r\n","import React from 'react'\r\n\r\nfunction Order() {\r\n    return (\r\n        <div>\r\n            Order\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Order\r\n","import Login from '../pages/Login'\r\nimport NotFound from '../pages/NotFound'\r\nimport Admin from '../pages/Admin'\r\nimport GoodsManage from '../pages/adminDir/GoodsManage'\r\nimport Order from '../pages/adminDir/Order'\r\nimport Category from '../pages/adminDir/Category'\r\nimport GoodsDetail from '../pages/adminDir/GoodsDetail'\r\nimport GoodsList from '../pages/adminDir/GoodsList'\r\n\r\nexport const mainRoutes=[\r\n    {\r\n        path:'/login',   \r\n        component:Login\r\n    },\r\n    {\r\n        path:'/404',\r\n        component:NotFound\r\n    },\r\n    {\r\n        path:'/admin',\r\n        component:Admin\r\n    }\r\n]\r\n\r\nexport const adminRoutes=[\r\n    {\r\n        path:'/admin/goodsManage',   \r\n        component:GoodsManage\r\n    },\r\n    {\r\n        path:'/admin/order',\r\n        component:Order\r\n    }\r\n]\r\n\r\nexport const goodsManageRoutes=[\r\n    {\r\n        path:'/admin/goodsManage/category',   \r\n        component:Category\r\n    },\r\n    {\r\n        path:'/admin/goodsManage/goodsDetail/:id',\r\n        component:GoodsDetail\r\n    },\r\n    {\r\n        path:'/admin/goodsManage/goodsList',   \r\n        component:GoodsList\r\n    }\r\n]","import React, { useReducer } from \"react\";\r\nimport { Layout, Menu } from \"antd\";\r\nimport { Switch, Route, Redirect, Link } from \"react-router-dom\";\r\n\r\nimport \"./Admin.less\";\r\nimport { adminRoutes } from \"../routes\";\r\nimport { getToken, clearToken } from \"../utils/auth\";\r\nimport {\r\n  selectedCategoryChainNodesContext,\r\n  reducer,\r\n  initSelectedCategoryChainNodes,\r\n} from \"../components/Reducer\";\r\n\r\nconst { Header, Content, Sider } = Layout;\r\n\r\nfunction Admin(props) {\r\n  const [\r\n    selectedCategoryChainNodes,\r\n    selectedCategoryChainNodesDispatch,\r\n  ] = useReducer(reducer, initSelectedCategoryChainNodes);\r\n\r\n  return getToken() ? (\r\n    <Layout className=\"layout\">\r\n      <Header className=\"header\">\r\n        电商网站后台管理系统\r\n        <span\r\n          onClick={() => {\r\n            clearToken();\r\n            props.history.push(\"/login\");\r\n          }}\r\n        >\r\n          退出登录\r\n        </span>\r\n      </Header>\r\n      <Layout>\r\n        <Sider width={200} className=\"site-layout-background\">\r\n          <Menu\r\n            mode=\"inline\"\r\n            selectedKeys={[props.location.pathname.split(\"/\")[2]]}\r\n            style={{ height: \"100%\", borderRight: 0, fontSize: 20 }}\r\n          >\r\n            <Menu.Item key=\"goodsManage\">\r\n              <Link to=\"/admin/goodsManage\">商品管理</Link>\r\n            </Menu.Item>\r\n            <Menu.Item key=\"order\">\r\n              <Link to=\"/admin/order\">订单管理</Link>\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Sider>\r\n        <Layout style={{ padding: \"0 24px 24px\" }}>\r\n          <Content\r\n            className=\"site-layout-background content\"\r\n            style={{\r\n              padding: 24,\r\n              margin: 0,\r\n              height: \"100%\",\r\n            }}\r\n          >\r\n            <selectedCategoryChainNodesContext.Provider\r\n              value={{\r\n                selectedCategoryChainNodes,\r\n                selectedCategoryChainNodesDispatch,\r\n              }}\r\n            >\r\n              <Switch>\r\n                {adminRoutes.map((item) => (\r\n                  <Route\r\n                    path={item.path}\r\n                    key={item.path}\r\n                    component={item.component}\r\n                  />\r\n                ))}\r\n                <Redirect to=\"/admin/order\" />\r\n              </Switch>\r\n            </selectedCategoryChainNodesContext.Provider>\r\n            <footer className=\"footer\"></footer>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    </Layout>\r\n  ) : (\r\n    <Redirect to=\"/login\" />\r\n  );\r\n}\r\n\r\nexport default Admin;\r\n","import React from \"react\";\nimport \"./App.css\";\nimport { BrowserRouter, Route, Switch, Redirect } from \"react-router-dom\";\n\nimport Login from \"./pages/Login\";\nimport Admin from \"./pages/Admin\";\n\nfunction App() {\n  return (\n    <BrowserRouter basename=\"back-manage\">\n      <Switch>\n        <Route\n          path=\"/login\"\n          render={(routeProps) => <Login {...routeProps} />}\n        />\n        <Route\n          path=\"/admin\"\n          render={(routeProps) => <Admin {...routeProps} />}\n        />\n        <Redirect to=\"/admin\" from=\"/\" />\n        <Redirect to=\"/404\" />\n      </Switch>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport 'antd/dist/antd.css';\nimport './index.css';\n\nReactDOM.render(\n  // <React.StrictMode>\n    <App />,\n  // </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}